<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LPJmL Data • lpjmlkit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LPJmL Data">
<meta property="og:description" content="lpjmlkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lpjmlkit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lpjml-data.html">LPJmL Data</a>
    </li>
    <li>
      <a href="../articles/lpjml-runner.html">LPJmL Runner</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PIK-LPJmL/lpjmlkit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LPJmL Data</h1>
                        <h4 data-toc-skip class="author">Jannes
Breier</h4>
            
            <h4 data-toc-skip class="date">2024-07-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PIK-LPJmL/lpjmlkit/blob/HEAD/vignettes/lpjml-data.Rmd" class="external-link"><code>vignettes/lpjml-data.Rmd</code></a></small>
      <div class="hidden name"><code>lpjml-data.Rmd</code></div>

    </div>

    
    
<p><strong>LPJmL Data</strong> 💾 is an lpjmlkit module that groups
around the data class <code>LPJmLData</code> and aims to facilitate
reading and processing of LPJmL inputs and outputs by combining the raw
data with available meta data (meta files, header files or manually) to
avoid a large overhead. It further enables easy subsetting,
transformations and basic statistics of the data and allows export to
common data formats.</p>
<p> </p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>LPJmL Data first requires reading LPJmL input or output data into R
by applying the read_io function (1). The returned object is of class
LPJmLData (2), for which basic statistics can be calculated (3), the
inner data can be modified (4), or exported (5) to common data
formats.</p>
<div class="section level4">
<h4 id="read-function-read_io">
<strong>1. 📖 Read function read_io</strong><br><a class="anchor" aria-label="anchor" href="#read-function-read_io"></a>
</h4>
<p><br>
read_io is a generic function to read LPJmL input and output files. It
currently supports three different file formats, “meta”, “clm” and
“raw”:</p>
<ul>
<li>
<p><strong>“meta”</strong> - <em>Easy to use and strongly
recommended</em>.<br>
Set <code>"output_metafile" : true</code> in your LPJmL run
configuration to generate output files in “meta” format. LPJmL input
files can also be created in “meta” format.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read monthly runoff with meta file.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span><span class="st">"./output/mrunoff.bin.json"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>“clm”</strong> - <em>Use if “meta” is not available or in
combination</em>.<br>
Most LPJmL input files use “clm” format. To write output files in “clm”
format set <code>"fmt" : "clm"</code> in your LPJmL run configuration.
Some optional meta data (e.g. <code>band_names</code>) need to be
specified manually while the basic information about file structure is
derived automatically from the file header.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read monthly runoff data with header.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span><span class="st">"./output/mrunoff.clm"</span>,</span>
<span>                 <span class="co"># If the clm version is lower than 4 set nbands and nstep</span></span>
<span>                 <span class="co"># manually so that month dimension is recognized correctly.</span></span>
<span>                 nbands <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 nstep <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                 <span class="co"># Useful additional information that is not needed to read the</span></span>
<span>                 <span class="co"># Data.</span></span>
<span>                 variable <span class="op">=</span> <span class="st">"runoff"</span>,</span>
<span>                 descr <span class="op">=</span> <span class="st">"monthly runoff"</span>,</span>
<span>                 unit <span class="op">=</span> <span class="st">"mm/month"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>“raw”</strong> - <em>Not recommended for use (with
lpjmlkit)</em>.<br>
By default, LPJmL output files are written as “raw” files
(<code>"fmt" : "raw"</code> in your LPJmL run configuration). These
files include no meta data about their structure or contents and should
therefore be combined with the <code>"output_metafile" : true</code>
setting to generate a corresponding “meta” file. Otherwise, all meta
data need to be specified by the user. Historically, some LPJmL input
files use “raw” format.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read monthly runoff raw data.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span><span class="st">"./output/mrunoff.bin"</span>,</span>
<span>                 <span class="co"># Specify all meta data if they differ from the function</span></span>
<span>                 <span class="co"># default values.</span></span>
<span>                 <span class="va">...</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
<p> </p>
</div>
<div class="section level4">
<h4 id="data-class-lpjmldata">
<strong>2. 📁 Data class LPJmLData</strong><br><a class="anchor" aria-label="anchor" href="#data-class-lpjmldata"></a>
</h4>
<p><br>
read_io returns an object of an R6 class <code>LPJmLData</code> with two
main attributes, <code>$data</code> and <code>$meta</code>:</p>
<ul>
<li>
<p><strong>$data</strong> A <code>class base::array</code> - returns
the data array with default dimensions “cell”, “time” and “band”</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runoff</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#     , , band = 1</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#          time</span></span>
<span><span class="co"># cell       1901-01-31    1901-02-28    1901-03-31    1901-04-30</span></span>
<span><span class="co">#   0      2.427786e+02  1.265680e+02  2.279087e+02  2.027685e+02</span></span>
<span><span class="co">#   1      4.189225e-14  1.032507e-16  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#   2      3.860512e-14  0.000000e+00  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#   3      0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#   4      0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#   5      0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span></span></code></pre></div>
</li>
<li>
<p><strong>$meta</strong> Meta data of class
<code>LPJmLMetaData</code> - returns the corresponding meta data
(e.g. <code>runoff$meta$unit</code>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runoff</span><span class="op">$</span><span class="va">meta</span></span>
<span><span class="co"># $sim_name "lu_cf"</span></span>
<span><span class="co"># $source "LPJmL C Version 5.3.001"</span></span>
<span><span class="co"># $history "./LPJmL_internal/bin/lpjml ./configurations/config_lu_cf.json"</span></span>
<span><span class="co"># $variable "runoff"</span></span>
<span><span class="co"># $descr "monthly runoff"</span></span>
<span><span class="co"># $unit "mm/month"</span></span>
<span><span class="co"># $nbands 1</span></span>
<span><span class="co"># $nyear 111</span></span>
<span><span class="co"># $firstyear 1901</span></span>
<span><span class="co"># $lastyear 2011</span></span>
<span><span class="co"># $nstep 12</span></span>
<span><span class="co"># $timestep 1</span></span>
<span><span class="co"># $ncell 67420</span></span>
<span><span class="co"># $firstcell 0</span></span>
<span><span class="co"># $cellsize_lon 0.5</span></span>
<span><span class="co"># $cellsize_lat 0.5</span></span>
<span><span class="co"># $datatype "float"</span></span>
<span><span class="co"># $scalar 1</span></span>
<span><span class="co"># $order "cellseq"</span></span>
<span><span class="co"># $bigendian FALSE</span></span>
<span><span class="co"># $format "raw"</span></span>
<span><span class="co"># $filename "runoff.bin"</span></span></code></pre></div>
<p> </p>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="basic-statistics-of-lpjmldata-objects">
<strong>3. 📈 Basic statistics of LPJmLData objects</strong><br><a class="anchor" aria-label="anchor" href="#basic-statistics-of-lpjmldata-objects"></a>
</h4>
<p><br>
To get an overview of the data, <code>LPJmLData</code> supports the
usage of the base functions: <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>, <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>,
<code>dimension()</code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. <em>More methods can be added in the
future.</em></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Self print; also via print(runoff).</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># $meta |&gt;</span></span>
<span><span class="co">#   .$sim_name "lu_cf"</span></span>
<span><span class="co">#   .$variable "runoff"</span></span>
<span><span class="co">#   .$descr "monthly runoff"</span></span>
<span><span class="co">#   .$unit "mm/month"</span></span>
<span><span class="co">#   .$nbands 1</span></span>
<span><span class="co">#   .$nyear 111</span></span>
<span><span class="co">#   .$nstep 12</span></span>
<span><span class="co">#   .$timestep 1</span></span>
<span><span class="co">#   .$ncell 67420</span></span>
<span><span class="co">#   .$cellsize_lon 0.5</span></span>
<span><span class="co">#   .$cellsize_lat 0.5</span></span>
<span><span class="co"># Note: not printing all meta data, use $meta to get all.</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$cell  "0" "1" "2" "3" ... "67419"</span></span>
<span><span class="co">#     .$time  ""1901-01-31" "1901-02-28" "1901-03-31" "1901-04-30" ... "2011-12-31"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># $summary()</span></span>
<span><span class="co">#        1</span></span>
<span><span class="co">#  Min.   :   0.0000</span></span>
<span><span class="co">#  1st Qu.:   0.0619</span></span>
<span><span class="co">#  Median :   4.4320</span></span>
<span><span class="co">#  Mean   :  28.7658</span></span>
<span><span class="co">#  3rd Qu.:  27.5627</span></span>
<span><span class="co">#  Max.   :2840.9602</span></span>
<span><span class="co"># Note: summary is not weighted by grid area.</span></span>
<span></span>
<span><span class="co"># Return the dimension length of $data array; dimnames function is also available.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">runoff</span><span class="op">)</span></span>
<span><span class="co">#  cell  time  band</span></span>
<span><span class="co"># 67420  1332     1</span></span>
<span></span>
<span><span class="co"># Plot as maps or time series, depending on the dimensions.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">runoff</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level4">
<h4 id="modify-lpjmldata-objects">
<strong>4. ✏ Modify LPJmLData objects</strong><br><a class="anchor" aria-label="anchor" href="#modify-lpjmldata-objects"></a>
</h4>
<p><br>
Each LPJmLData object comes with a bundle of methods to modify its
state: <code><a href="../reference/add_grid.html">add_grid()</a></code>, <code><a href="../reference/transform.html">transform()</a></code> and
<code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code>.</p>
<ul>
<li>
<p><strong>📍 <code><a href="../reference/add_grid.html">add_grid()</a></code></strong> Adds a
<strong>$grid</strong> attribute (as an LPJmLData object) to the object,
providing the spatial reference (longitude and latitude) for each
cell.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Object- oriented (R6 class) notation (assigning grid directly to runoff)</span></span>
<span><span class="va">runoff</span><span class="op">$</span><span class="fu">add_grid</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Common R notation (overwriting the original object)</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_grid.html">add_grid</a></span><span class="op">(</span><span class="va">runoff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the read_io arguments if a grid file cannot be detected automatically.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_grid.html">add_grid</a></span><span class="op">(</span><span class="va">runoff</span>, <span class="st">"./output/grid.clm"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>🔁 <code><a href="../reference/transform.html">transform()</a></code></strong> the
<code>$data</code> dimensions.<br>
Transforms the spatial dimension from “cell” to “lon” (longitude) and
“lat” (latitude) or the temporal dimension “time” into separate “year”,
“month”, and “day” dimensions. Combinations and back transformations are
also possible. Transformation into the format “lon_lat” requires a
<code>$grid</code> attribute (see <code>add_grid</code> above). Any
transformation does not change the contents of the data, only the
structure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transform into lon and lat dimensions. If add_grid has not been executed</span></span>
<span><span class="co">#   before it is called implicitly.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span><span class="va">runoff</span>, to <span class="op">=</span> <span class="st">"lon_lat"</span><span class="op">)</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$lat  "-55.75" "-55.25" "-54.75" "-54.25" ... "83.75"</span></span>
<span><span class="co">#     .$lon  "-179.75" "-179.25" "-178.75" "-178.25" ... "179.75"</span></span>
<span><span class="co">#     .$time  "1901-01-31" "1901-02-28" "1901-03-31" "1901-04-30" ... "2011-12-31"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># [...]</span></span>
<span></span>
<span><span class="co"># Transform into year and month dimensions (day not available for monthly</span></span>
<span><span class="co">#   runoff)</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span><span class="va">runoff</span>, to <span class="op">=</span> <span class="st">"year_month_day"</span><span class="op">)</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$lat  "-55.75" "-55.25" "-54.75" "-54.25" ... "83.75"</span></span>
<span><span class="co">#     .$lon  "-179.75" "-179.25" "-178.75" "-178.25" ... "179.75"</span></span>
<span><span class="co">#     .$month  "1" "2" "3" "4" ... "12"</span></span>
<span><span class="co">#     .$year  "1901" "1902" "1903" "1904" ... "2011"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># [...]</span></span>
<span></span>
<span><span class="co"># Transform back to original dimensions.</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span><span class="va">runoff</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell"</span>, <span class="st">"time"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$cell  "0" "1" "2" "3" ... "67419"</span></span>
<span><span class="co">#     .$time  "1901-01-31" "1901-02-28" "1901-03-31" "1901-04-30" ... "2100-12-31"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># [...]</span></span></code></pre></div>
</li>
<li>
<p><strong>✂ <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code></strong> the
<code>$data</code>.<br>
Use <code>$data</code> dimensions as keys and names or indices as values
to subset <code>$data</code>. <code>$meta</code> data are adjusted
according to the subset. Applying a subset changes the contents of the
data and cannot be reversed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset by dimnames (character string).</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">runoff</span>, time <span class="op">=</span> <span class="st">"1991-05-31"</span><span class="op">)</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># $meta |&gt;</span></span>
<span><span class="co">#   .$nyear 1</span></span>
<span><span class="co">#   .$ncell 67420</span></span>
<span><span class="co">#   .$subset TRUE</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># Note: not printing all meta data, use $meta to get all.</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$cell  "0" "1" "2" "3" ... "67419"</span></span>
<span><span class="co">#     .$time  "1991-05-31"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># [...]</span></span>
<span></span>
<span><span class="co"># Subset by indices</span></span>
<span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">runoff</span>, cell <span class="op">=</span> <span class="fl">28697</span><span class="op">:</span><span class="fl">28700</span><span class="op">)</span></span>
<span><span class="va">runoff</span></span>
<span><span class="co"># $meta |&gt;</span></span>
<span><span class="co">#   .$nyear 1</span></span>
<span><span class="co">#   .$ncell 4</span></span>
<span><span class="co">#   .$subset TRUE</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># Note: not printing all meta data, use $meta to get all.</span></span>
<span><span class="co"># $data |&gt;</span></span>
<span><span class="co">#   dimnames() |&gt;</span></span>
<span><span class="co">#     .$cell  "28696" "28697" "28698" "28699"</span></span>
<span><span class="co">#     .$time  "1991-05-31"</span></span>
<span><span class="co">#     .$band  "1"</span></span>
<span><span class="co"># [...]</span></span></code></pre></div>
<p> </p>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="export-lpjmldata-objects">
<strong>5. 📦 Export LPJmLData objects</strong><br><a class="anchor" aria-label="anchor" href="#export-lpjmldata-objects"></a>
</h4>
<p><br>
Finally, LPJmLData objects can be exported into common R data formats:
<code>array</code>, <code>tibble</code>, <code>raster</code> and
<code>terra</code>.<br><em>More export methods can be added in the future.</em></p>
<ul>
<li>
<p><strong><code><a href="../reference/as_array.html">as_array()</a></code></strong> Export
<code>$data</code> as an array. In addition to simply returning the
<code>$data</code> element of an <code>LPJmLData</code> object, as_array
provides functionalities to subset and aggregate <code>$data</code>.
Subsetting is conducted before aggregation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export as an array with subset of first 6 time steps and aggregation along</span></span>
<span><span class="co">#   the dimension cell (mean).</span></span>
<span><span class="fu"><a href="../reference/as_array.html">as_array</a></span><span class="op">(</span><span class="va">runoff</span>,</span>
<span>         subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>         aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#             band</span></span>
<span><span class="co"># time                1</span></span>
<span><span class="co">#   1901-01-31 19.49611</span></span>
<span><span class="co">#   1901-02-28 20.28368</span></span>
<span><span class="co">#   1901-03-31 27.93595</span></span>
<span><span class="co">#   1901-04-30 36.90505</span></span>
<span><span class="co">#   1901-05-31 39.38885</span></span>
<span><span class="co">#   1901-06-30 32.80252</span></span></code></pre></div>
</li>
<li>
<p><strong><code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble()</a></code></strong> Export
<code>$data</code> as a <a href="https://tibble.tidyverse.org/" class="external-link"><code>tibble</code></a> object,
providing the same additional subsetting and aggregation functionality
as as_array.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export as a tibble with subset of first 6 time steps</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">runoff</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 404,520 × 4</span></span>
<span><span class="co">#    cell  time       band  value</span></span>
<span><span class="co">#    &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#  1 0     1901-01-31 1      184.</span></span>
<span><span class="co">#  2 1     1901-01-31 1        0</span></span>
<span><span class="co">#  3 2     1901-01-31 1        0</span></span>
<span><span class="co">#  4 3     1901-01-31 1        0</span></span>
<span><span class="co">#  5 4     1901-01-31 1        0</span></span>
<span><span class="co">#  6 5     1901-01-31 1        0</span></span>
<span><span class="co">#  7 6     1901-01-31 1        0</span></span>
<span><span class="co">#  8 7     1901-01-31 1        0</span></span>
<span><span class="co">#  9 8     1901-01-31 1        0</span></span>
<span><span class="co"># 10 9     1901-01-31 1        0</span></span>
<span><span class="co"># # … with 404,510 more rows</span></span></code></pre></div>
</li>
<li>
<p><strong>🌐 <code><a href="../reference/as_raster.html">as_raster()</a></code></strong> /
<strong><code><a href="../reference/as_terra.html">as_terra()</a></code></strong> Export <code>$data</code> as a
<a href="https://rspatial.github.io/raster/reference/raster-package.html" class="external-link"><code>raster</code></a>
or a <a href="https://rspatial.org/" class="external-link"><code>terra</code></a> object
(successor of raster), providing the same additional subsetting and
aggregation functionality as <code><a href="../reference/as_array.html">as_array()</a></code>. as_raster()
returns a RasterLayer for a single data field and a RasterBrick if the
result contains more than one band or more than one time step.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export the first time step as a RasterLayer object from the raster package.</span></span>
<span><span class="fu"><a href="../reference/as_raster.html">as_raster</a></span><span class="op">(</span><span class="va">runoff</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># class      : RasterLayer</span></span>
<span><span class="co"># dimensions : 280, 720, 201600  (nrow, ncol, ncell)</span></span>
<span><span class="co"># resolution : 0.5, 0.5  (x, y)</span></span>
<span><span class="co"># extent     : -180, 180, -56, 84  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># crs        : +proj=longlat +datum=WGS84 +no_defs # nolint:commented_code_linter.</span></span>
<span><span class="co"># source     : memory</span></span>
<span><span class="co"># names      : runoff</span></span>
<span><span class="co"># values     : -1.682581e-13, 671.8747  (min, max)</span></span>
<span></span>
<span><span class="co"># Export the first time step as a terra SpatRaster object.</span></span>
<span><span class="fu"><a href="../reference/as_terra.html">as_terra</a></span><span class="op">(</span><span class="va">runoff</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># class       : SpatRaster</span></span>
<span><span class="co"># dimensions  : 280, 720, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.5, 0.5  (x, y)</span></span>
<span><span class="co"># extent      : -180, 180, -56, 84  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326)</span></span>
<span><span class="co"># source      : memory</span></span>
<span><span class="co"># name        :        runoff</span></span>
<span><span class="co"># min value   : -1.682581e-13</span></span>
<span><span class="co"># max value   :  6.718747e+02</span></span>
<span><span class="co"># unit        :      mm/month # nolint:commented_code_linter.</span></span>
<span></span>
<span><span class="co"># Export the first 4 times step as a RasterBrick object.</span></span>
<span><span class="fu"><a href="../reference/as_raster.html">as_raster</a></span><span class="op">(</span><span class="va">runoff</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># class      : RasterBrick</span></span>
<span><span class="co"># dimensions : 280, 720, 201600, 4  (nrow, ncol, ncell, nlayers)</span></span>
<span><span class="co"># resolution : 0.5, 0.5  (x, y)</span></span>
<span><span class="co"># extent     : -180, 180, -56, 84  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># crs        : +proj=longlat +datum=WGS84 +no_defs # nolint:commented_code_linter.</span></span>
<span><span class="co"># source     : memory</span></span>
<span><span class="co"># names      :   X1901.01.31,   X1901.02.28,   X1901.03.31,   X1901.04.30</span></span>
<span><span class="co"># min values : -1.682581e-13, -1.750495e-13, -2.918900e-13, -1.516298e-13</span></span>
<span><span class="co"># max values :      671.8747,      785.2363,      828.2853,      987.4359</span></span>
<span></span>
<span><span class="co"># Export the first 4 time steps as a terra SpatRaster object.</span></span>
<span><span class="fu"><a href="../reference/as_terra.html">as_terra</a></span><span class="op">(</span><span class="va">runoff</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># class       : SpatRaster</span></span>
<span><span class="co"># dimensions  : 280, 720, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.5, 0.5  (x, y)</span></span>
<span><span class="co"># extent      : -180, 180, -56, 84  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326)</span></span>
<span><span class="co"># source      : memory</span></span>
<span><span class="co"># names       :    1901-01-31,    1901-02-28,    1901-03-31,    1901-04-30</span></span>
<span><span class="co"># min values  : -1.682581e-13, -1.750495e-13, -2.918900e-13, -1.516298e-13</span></span>
<span><span class="co"># max values  :  6.718747e+02,  7.852363e+02,  8.282853e+02,  9.874359e+02</span></span>
<span><span class="co"># unit        :      mm/month,      mm/month,      mm/month,      mm/month</span></span>
<span><span class="co"># time (days) : 1901-01-31 to 1901-04-30</span></span></code></pre></div>
<p> </p>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="miscellaneous">
<strong>Miscellaneous</strong><br><a class="anchor" aria-label="anchor" href="#miscellaneous"></a>
</h4>
<p><br>
More helpful functionality included with LPJmL Data:</p>
<ul>
<li><p><code><a href="../reference/read_meta.html">read_meta()</a></code> to read meta information from meta and
header files as <code>LPJmLMetaData</code> objects.
<code>LPJmLMetaData</code> are usually attached to an
<code>LPJmLData</code> object but can also be used to gain information
about an LPJmL input or output file without reading the data.</p></li>
<li><p><code>LPJmLMetaData</code> objects can be exported as
<code>as_list</code> and <code>as_header</code> to create header objects
or write header files.</p></li>
<li><p><code><a href="../reference/read_header.html">read_header()</a></code>, <code><a href="../reference/write_header.html">write_header()</a></code>,
<code><a href="../reference/get_headersize.html">get_headersize()</a></code>, <code><a href="../reference/get_datatype.html">get_datatype()</a></code> provide
low-level interaction with LPJmL input and output files primarily in
“clm” format.</p></li>
</ul>
<p>   </p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PIK-LPJmL/lpjmlkit" class="external-link">lpjmlkit</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-global-trend-in-net-primary-productivity-npp-over-the-years">
<strong>1. Example</strong> <em>Global Trend in net primary
productivity (NPP) over the years</em><a class="anchor" aria-label="anchor" href="#example-global-trend-in-net-primary-productivity-npp-over-the-years"></a>
</h4>
<p> </p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">npp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"./output/npp.bin.json"</span>,</span>
<span>               subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">:</span><span class="fl">2011</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transform "time" into "year" and "month" dimensions.</span></span>
<span><span class="va">npp</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span>to <span class="op">=</span> <span class="st">"year_month_day"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot timeseries with aggregated cell and month dimensions. Note that spatial</span></span>
<span><span class="co"># aggregation across cells is not area-weighted.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">npp</span>,</span>
<span>     aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">mean</span>, month <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also available as data array.</span></span>
<span><span class="va">global_npp_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_array.html">as_array</a></span><span class="op">(</span><span class="va">npp</span>,</span>
<span>                             aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">mean</span>, month <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-runoff-in-northern-hemisphere-during-summertime">
<strong>2. Example</strong> <em>Runoff in northern hemisphere during
summertime</em><a class="anchor" aria-label="anchor" href="#example-runoff-in-northern-hemisphere-during-summertime"></a>
</h4>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"./output/runoff.bin.json"</span>,</span>
<span>               subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">2002</span><span class="op">:</span><span class="fl">2011</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Usage of pipe operator operator |&gt; (%&gt;% via package magrittr R version &lt; 4.1)</span></span>
<span><span class="va">runoff</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Transform the time and space dimensions ...</span></span>
<span>  <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span>to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year_month_day"</span>, <span class="st">"lon_lat"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># ... to subset summer months as well as northern hemisphere (positive)</span></span>
<span>  <span class="co">#   latitudes.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">9</span>,</span>
<span>         lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">83.75</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># for plotting sum up summer month and take the average over the years</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">mean</span>, month <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-gross-primary-productivity-gpp-per-latitude">
<strong>3. Example</strong> <em>Gross primary productivity (GPP) per
latitude</em><a class="anchor" aria-label="anchor" href="#example-gross-primary-productivity-gpp-per-latitude"></a>
</h4>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"./output/gpp.bin.json"</span>,</span>
<span>               subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">2002</span><span class="op">:</span><span class="fl">2011</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transform into lon_lat format.</span></span>
<span><span class="va">gpp</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span>to <span class="op">=</span> <span class="st">"lon_lat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot GPP per latitude.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gpp</span>, aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">mean</span>, lon <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-cft-fractions-for-area-around-potsdam">
<strong>4. Example</strong> <em>CFT fractions for area around
Potsdam</em><a class="anchor" aria-label="anchor" href="#example-cft-fractions-for-area-around-potsdam"></a>
</h4>
<p> </p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coordinates for cells around Potsdam.</span></span>
<span><span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52.25</span>, <span class="fl">52.400922</span>, <span class="fl">53.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.75</span>, <span class="fl">13.03638</span>, <span class="fl">12.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Complete pipe notation, from reading to plotting data.</span></span>
<span><span class="fu"><a href="../reference/read_io.html">read_io</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="fu">glue</span><span class="op">(</span><span class="st">"./cftfrac.bin.json"</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">:</span><span class="fl">2018</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span>to <span class="op">=</span> <span class="st">"lon_lat"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Special case for subsetting of lat and lon pairs</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">coordinates</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Mean across spatial dimensions</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>aggregate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="va">mean</span>, lat <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>   </p>
</div>
<div class="section level3">
<h3 id="notes-tips">Notes &amp; tips<a class="anchor" aria-label="anchor" href="#notes-tips"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p><code>LPJmLData</code> and <code>LPJmLMetaData</code> objects are
closed environments, each of an R6 class, that function as a data
container.<br>
Do not replicate R6 objects like</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">my_copy</span> <span class="op">&lt;-</span> <span class="va">lpjml_data</span></span>
<span>  <span class="co"># Instead use:</span></span>
<span>  <span class="va">my_copy</span> <span class="op">&lt;-</span> <span class="va">lpjml_data</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Otherwise, <code>my_copy</code> and <code>lpjml_data</code> point to
the same environment, and any subsetting or transformation methods
applied to <code>my_copy</code> will also affect
<code>lpjml_data</code>.</p>
</li>
<li><p>Do not try to manually overwrite either the <code>$data</code> or
any <code>$meta</code> data attributes within <code>LPJmLData</code>
objects. It is either not possible or can mess up the integrity of the
object. Methods surrounded by double underscores
(<code>$.__&lt;method&gt;__)</code> or attributes surrounded by
underscores (<code>$._&lt;attribute&gt;_</code>) are only for low-level
package development and should not be used by users for their data
handling.</p></li>
<li><p>When performance is important, choose R6 method notation
<code>runoff$transform(to = "lon_lat")</code> over common R notation
<code>transform(runoff, to = "lon_lat")</code>.</p></li>
<li><p>The “meta” format is only supported by recent LPJmL versions.
When comparing older (&lt; LPJmL version 5.3) output data with LPJmL 5.3
output data it can be useful to combine meta
(<code>"output_metafile" : true</code>) with the header file format
(<code>"fmt": "clm"</code>), which has been supported since LPJmL
version 4, for simplification of process pipelines.</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jannes Breier, Sebastian Ostberg, Stephen Björn Wirth, Sara Minoli, Fabian Stenzel, Christoph Müller.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
